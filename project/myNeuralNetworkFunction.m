function [y1] = myNeuralNetworkFunction(x1)
%MYNEURALNETWORKFUNCTION neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 14-Apr-2015 21:42:11.
%
% [y1] = myNeuralNetworkFunction(x1) takes these arguments:
%   x = 13xQ matrix, input #1
% and returns:
%   y = 7xQ matrix, output #1
% where Q is the number of samples.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [1863;0;0;0;-146;0;105.666666666667;0;0;99;0;1;1];
x1_step1_gain = [0.00100704934541793;0.00555555555555556;0.0384615384615385;0.00148920327624721;0.00285714285714286;0.000290275761973875;0.0185185185185185;0.000286000286000286;0.0078740157480315;0.0129032258064516;0.00806451612903226;0.666666666666667;0.0512820512820513];
x1_step1_ymin = -1;

% Layer 1
b1 = [-2.2299542916161652;-1.9193197894149137;-1.21399572577923;0.61775226039141484;-0.190861658582406;-0.011628358143436855;-1.1411976328391296;-0.70238218255526863;1.1151249583083329;3.4567011001302155];
IW1_1 = [4.5274163092739137 -0.017688247859236641 0.10258042301360221 -0.029296456520505925 -0.14794822092394014 0.34332722735277932 0.10131936625733423 -0.44506309255740328 -0.21892327456711524 0.74791859380710157 -0.90933992824248211 -0.64805236537264177 0.50307808848363444;0.30782150555395454 0.022700914657144335 -0.11053952813976065 0.38741207570445946 0.51708174852834821 0.60611913286387298 -0.50325753333775225 -0.3886036094913391 -0.97011140088041103 0.41478512827955244 -0.55006636047973401 0.17145299812029932 -0.18753600605328116;-1.564312002643065 -0.10929318289007289 0.70187803514948033 1.1808681529008342 0.89039360103846243 -0.98531771822345182 -0.35392666013550328 -0.13484049020153413 0.30178061046329169 0.92369862992879281 -0.34912399562549207 1.5374482838601673 -0.74877720455328911;2.103797238011416 0.0087551189589099646 -0.25922854926974875 1.2246312916155537 -0.49244422074228861 -1.6126801645204349 -0.26836499577218603 -0.94182867918182023 -0.089972058359566343 -2.0365438932878592 1.6098321270112621 -0.16268425961424235 -0.36630815689743684;6.4699215579205687 0.088716610049617256 -0.27619083334089783 -0.33090591178542605 -0.42651678749352817 -1.7503711593031903 -0.69459646386691276 1.3090710128414313 -0.85212312912655941 -0.63442233607981757 0.18998636191038851 0.070068425914818724 0.061005254685928829;4.4402701650843257 -0.17925281605300541 0.25276900887294446 0.00119082825061783 -0.46858131452284024 -0.38051204505710778 0.61744318336008996 -0.37319581276050823 -0.59528413404772751 0.64210234601726779 -0.71107228062975492 -1.1722121727820556 0.18738410796540994;0.85999736385576908 -0.1746962381218532 0.32595312818813499 -0.60085587483640512 -0.26489435313508713 2.9703082253267481 1.0930439498405484 -1.626885558801316 -0.15601699477740535 1.2949250027600119 -0.84290404226287985 -2.2706934862048471 -0.66760677966399318;1.0887543985495429 0.30046804613611716 0.70338119780172703 -0.52144388175174083 0.16023520230057953 -0.13950207987977856 1.4321452541324853 -0.32672356463363372 1.167696601517203 0.74429475167104131 -0.43138578094949553 -3.4627377579997445 -1.0475295491209502;-1.9687894514961151 -0.12569467843410981 0.71758324417284269 1.0365746447761168 -0.14884653249392632 -1.5050819983263424 0.36817527541261741 1.358229949364232 -0.25467217228365963 0.00035302839905763939 -0.50366576536169783 -0.064512431685737198 0.37525555927160187;-0.43960982778009383 0.034620858849889351 -0.43851739282076108 0.43451794260321697 -0.49726611021175809 1.215483524483965 0.049929500594645404 0.18798755184832253 -0.69221929491636991 -0.7394286348764596 1.3334406463719801 0.96734605664706341 -1.3485611667997222];

% Layer 2
b2 = [1.3435319029742154;0.7868131122309775;-0.35891298199629251;-2.2158070990787357;-0.17612485027271968;0.87600312368039679;0.17752022722979482];
LW2_1 = [-0.21353798698400125 -0.16063993937167279 -2.1573425813656533 0.6013022167889861 1.9882849257454258 1.4322148199621774 1.4995632790419879 -0.24524938122056339 -0.14901575230775624 1.5263578775386968;-0.63562492331335207 -0.69729076125070699 -0.99616752194608771 0.60044843932194769 0.1373835812317879 2.3022253405305757 1.0402026644900895 0.1761576521018213 1.0168662829819923 1.6240736370062128;-0.81383312699180033 -0.34979451308332238 2.2672160298269648 0.066663889316181724 -2.1316002430275902 -1.8456112632648787 1.0849016902206139 1.2793700600056017 0.65630203553255928 0.22148781364952594;0.60032488977176945 1.4993973318126945 0.63219605810617263 -4.5210606181546806 -0.80073444551465889 -5.0505352832495527 -1.2033320967964294 -3.0669006920899076 0.34014307147208889 -2.0493582723802133;-3.6503151643491405 1.2485413210930936 -0.3252153659017108 -0.15330552253834781 -3.9433067700640385 3.4315736750256636 -2.5961904999439049 2.0888846818392866 -1.1812158922624458 -2.591107598458025;-0.56616551828785866 0.73038732577826937 -0.94124318710321597 0.057041264522437816 -0.2041532902436298 -3.7160765380227136 -1.4758743716848968 0.4370540233988498 -0.099678063179469589 0.23690071794921724;4.1288373868969783 0.37694057823600136 -0.20693231225997835 -0.96947292164936039 5.2708418974026809 2.6590726388742039 0.15420766924724483 -2.0129917877990224 -1.5267563974575953 0.728797867629284];

% ===== SIMULATION ========

% Dimensions
Q = size(x1,2); % samples

% Input 1
xp1 = mapminmax_apply(x1,x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);

% Layer 1
a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*xp1);

% Layer 2
a2 = softmax_apply(repmat(b2,1,Q) + LW2_1*a1);

% Output 1
y1 = a2;
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Competitive Soft Transfer Function
function a = softmax_apply(n)
nmax = max(n,[],1);
n = bsxfun(@minus,n,nmax);
numer = exp(n);
denom = sum(numer,1);
denom(denom == 0) = 1;
a = bsxfun(@rdivide,numer,denom);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end
